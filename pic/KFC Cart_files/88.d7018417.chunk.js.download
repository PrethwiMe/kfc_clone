(this["webpackJsonpreusable-comps"]=this["webpackJsonpreusable-comps"]||[]).push([[88],{891:function(e,t,o){"use strict";o.r(t);var d=o(3),i=o(25),n=o(61),r=o(6),l=o(268);var u={ORDERS_NOW:"ordersNow",TRACK_ORDER:"trackOrder",WE_ARE_WORKING_ON:"weAreWorkingOn",YOUR_ORDER:"yourOrder",HAS_BEEN_CONFIRMED:"hasBeenConfirmed",HAS_SCHEDULED:"hasScheduled",PICKUP:"takeaway",AT:"At",DELIVERY:"delivery"},c=o(0),v=o(5),a=o(972),s=o(171),O=o(2);t.default=e=>{const t=Object(i.b)(),o={history:Object(n.g)()},{tenantReducer:E,orderHistoryReducer:I,profileReducer:D,appStateReducer:{userStatus:{loggedIn:R}={}}={}}=Object(i.c)((e=>e)),[b,A]=Object(d.useState)(!1),[_,f]=Object(d.useState)(""),[S,T]=Object(d.useState)(),h=()=>{S&&(clearTimeout(S),T(void 0))};Object(d.useEffect)((()=>(h(),t(Object(l.e)()),()=>h())),[]);const m=()=>{if(R&&null!==D&&void 0!==D&&D.customerId&&null!==E&&void 0!==E&&E.tenantId&&null!==e&&void 0!==e&&e.isHeaderTrackOrderEnabled()){const e={OrderStatus:"",OrderMode:""};t(Object(l.c)({customerId:null===D||void 0===D?void 0:D.customerId,tenantId:null===E||void 0===E?void 0:E.tenantId},e))}};Object(d.useEffect)((()=>{h(),m()}),[null===D||void 0===D?void 0:D.customerId,null===E||void 0===E?void 0:E.tenantId]);Object(d.useEffect)((()=>{var t,o,d,i;!I||null===I||void 0===I||!I.activeOrderHistory||null!==I&&void 0!==I&&I.activeOrderHistoryLoading||(null!==I&&void 0!==I&&null!==(t=I.activeOrderHistory)&&void 0!==t&&t.length?(!1===(null===E||void 0===E||null===(o=E.componentOptions)||void 0===o||null===(d=o.web)||void 0===d||null===(i=d.global)||void 0===i?void 0:i.showBlackStripWithOrderTracker)&&e.setShowBlackStripeContent(!1),!b&&A(!0),f(N()),!S&&T(setTimeout((()=>{h(),m()}),18e4))):b&&A(!1))}),[null===I||void 0===I?void 0:I.activeOrderHistory]);const N=()=>{var e,t;if(1!==(null===I||void 0===I||null===(e=I.activeOrderHistory)||void 0===e?void 0:e.length))return"".concat(Object(r.translateWithI18Next)(u.WE_ARE_WORKING_ON)," ").concat(null===I||void 0===I||null===(t=I.activeOrderHistory)||void 0===t?void 0:t.length," ").concat(Object(r.translateWithI18Next)(u.ORDERS_NOW));{var o;const e=null===I||void 0===I?void 0:I.activeOrderHistory[0];if(!1===(null===e||void 0===e||null===(o=e.requestedDateTime)||void 0===o?void 0:o.isForNow)){const t="".concat(Object(r.translateWithI18Next)(u.YOUR_ORDER)," # ").concat(null===e||void 0===e?void 0:e.posOrderId," ").concat(Object(r.translateWithI18Next)(u.HAS_SCHEDULED)," ");return Object(v.ef)(null===e||void 0===e?void 0:e.service)===c.Jb.DELIVERY?"".concat(t," ").concat(Object(r.translateWithI18Next)(u.DELIVERY)," ").concat(Object(r.translateWithI18Next)(u.AT)):Object(v.ef)(null===e||void 0===e?void 0:e.service)===c.Jb.PICKUP?"".concat(t," ").concat(Object(r.translateWithI18Next)(u.PICKUP)," ").concat(Object(r.translateWithI18Next)(u.AT)):"".concat(t)}if(Object(v.ef)(null===e||void 0===e?void 0:e.service)===c.Jb.DELIVERY)return"".concat(Object(r.translateWithI18Next)(u.YOUR_ORDER)," # ").concat(null===e||void 0===e?void 0:e.posOrderId," ").concat(Object(r.translateWithI18Next)(u.HAS_BEEN_CONFIRMED));var d;if(Object(v.ef)(null===e||void 0===e?void 0:e.service)===c.Jb.PICKUP)return"".concat(Object(r.translateWithI18Next)(u.WE_ARE_WORKING_ON)," ").concat(null===I||void 0===I||null===(d=I.activeOrderHistory)||void 0===d?void 0:d.length," ").concat(Object(r.translateWithI18Next)(u.ORDERS_NOW))}},g=Object(d.useCallback)((()=>{var e,t;(null===I||void 0===I||null===(e=I.activeOrderHistory)||void 0===e?void 0:e.length)>1?Object(v.Ae)(o):1===(null===I||void 0===I||null===(t=I.activeOrderHistory)||void 0===t?void 0:t.length)&&(e=>{if(null!==e&&void 0!==e&&e.id){const t={...e,customer:null===D||void 0===D?void 0:D.basic},d=Object(a.w)(null===E||void 0===E?void 0:E.tenantId,t);d.postOrderDetails={},sessionStorage.setItem(c.gd.ORDER_TRACKING,JSON.stringify(d)),Object(v.ce)()?Object(v.Qe)(o):Object(v.Te)(o)}else console.error(JSON.stringify(e)),Object(v.Se)(o)})(null===I||void 0===I?void 0:I.activeOrderHistory[0])}),[I]);return b&&Object(O.jsx)(s.a,{...e,testId:"HeaderTrackOrderItems",importPath:"APP_HEADER_ORDER_TRACKER_VIEW",buttonText:Object(r.translateWithI18Next)(u.TRACK_ORDER),trackOrderTitle:_,onTrackOrderBtnClickHandler:g})}},951:function(e,t,o){"use strict";o.d(t,"a",(function(){return d})),o.d(t,"c",(function(){return i})),o.d(t,"b",(function(){return n})),o.d(t,"d",(function(){return r}));const d=20,i=5e3,n=15e3,r=18e4},972:function(e,t,o){"use strict";o.d(t,"p",(function(){return a})),o.d(t,"o",(function(){return s})),o.d(t,"l",(function(){return O})),o.d(t,"f",(function(){return E})),o.d(t,"m",(function(){return I})),o.d(t,"n",(function(){return D})),o.d(t,"h",(function(){return R})),o.d(t,"j",(function(){return b})),o.d(t,"i",(function(){return A})),o.d(t,"g",(function(){return _})),o.d(t,"k",(function(){return f})),o.d(t,"r",(function(){return T})),o.d(t,"a",(function(){return h})),o.d(t,"b",(function(){return N})),o.d(t,"d",(function(){return g})),o.d(t,"c",(function(){return j})),o.d(t,"s",(function(){return L})),o.d(t,"v",(function(){return C})),o.d(t,"q",(function(){return p})),o.d(t,"u",(function(){return P})),o.d(t,"w",(function(){return y})),o.d(t,"e",(function(){return V})),o.d(t,"t",(function(){return Y}));var d=o(138),i=o(102),n=o(30),r=o(5),l=o(0),u=o(951),c=o(22),v=o(42);const a=e=>S(e)===l.Od.STAGED_ACCEPTED,s=e=>S(e)===l.Od.PICKUP_DELIVERY_DINE_IN,O=e=>Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.DELIVERY&&s(e),E=e=>Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.DELIVERY&&(O(e)||R(e)||b(e)||A(e)),I=e=>E(e)&&(null===e||void 0===e?void 0:e.deliveryPartner),D=e=>E(e)&&!A(e)&&!_(e),R=e=>S(e)===l.Od.DELIVERY_DISTA_CREATE_ASSIGN,b=e=>S(e)===l.Od.DELIVERY_DISTA,A=e=>S(e)===l.Od.DELIVERY_DISTA_DELIVERED,_=e=>S(e)===l.Od.CANCELLED,f=e=>b(e)||_(e)||A(e),S=e=>{switch(Object(r.ef)(null===e||void 0===e?void 0:e.status)){case l.Qd.STAGED:case l.Qd.ACCEPTED:return c.b.shouldGoogleSpotIgnoreOloFailure?l.Od.PICKUP_DELIVERY_DINE_IN:l.Od.STAGED_ACCEPTED;case l.Qd.SENT_TO_POS_COMPLETED:if(Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.PICKUP||Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.DINE_IN||Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.DELIVERY||Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.CHRISTMAS_ORDERING)return l.Od.PICKUP_DELIVERY_DINE_IN;break;case l.Qd.CREATED:case l.Qd.ASSIGNED:return l.Od.DELIVERY_DISTA_CREATE_ASSIGN;case l.Qd.PICKED_UP:case l.Qd.OUT_FOR_DELIVERY:case l.Qd.ARRIVED:return l.Od.DELIVERY_DISTA;case l.Qd.DELIVERED:return l.Od.DELIVERY_DISTA_DELIVERED;case l.Qd.CANCELLED:case l.Qd.CANCEL:return Object(r.ef)(null===e||void 0===e?void 0:e.service)===l.Lb.DELIVERY?l.Od.CANCELLED:l.Od.FAILED;case l.Qd.SENT_TO_POS_FAILED:case l.Qd.PAYMENT_FAILED:return l.Od.FAILED}},T=(e,t,o)=>{if(null!==e&&void 0!==e&&e.orderAcceptedLoading)return Promise.resolve(!1);switch(S(e)){case l.Od.STAGED_ACCEPTED:return t(!0),Promise.resolve(!1);case l.Od.PICKUP_DELIVERY_DINE_IN:return t(!1),Promise.resolve(!0);case l.Od.DELIVERY_DISTA_CREATE_ASSIGN:case l.Od.DELIVERY_DISTA:case l.Od.DELIVERY_DISTA_DELIVERED:case l.Od.CANCELLED:return t(!1),Promise.resolve(!1);case l.Od.FAILED:return localStorage.setItem(l.Td.STATUS_TEXT,l.Td.FAILED),Object(r.Se)(o),Promise.resolve(!1)}},h=e=>{let{dispatch:t,orderDetails:o,orderAccepted:d,cartData:i,userOrderState:u,appStateReducer:v,isBasketLoading:a,status:s,qrCodeScanTime:O}=e;if(s){const e=v.userStatus,s=c.b.shouldGoogleSpotIgnoreOloFailure||Object(r.ef)(null===d||void 0===d?void 0:d.status)===l.Qd.SENT_TO_POS_COMPLETED;Object(r.l)(s,!a,null===i||void 0===i?void 0:i.id,e.localized,null===o||void 0===o?void 0:o.tenantId)&&Object(r.G)(t,n.f,null===o||void 0===o?void 0:o.tenantId,u,O)}},m=(e,t,o)=>{t&&(o=setTimeout((()=>{t(e),o&&clearTimeout(o)}),u.c))},N=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n={emailId:null===t||void 0===t?void 0:t.userEmail,phoneNo:null===t||void 0===t?void 0:t.userPhone,orderNo:null===t||void 0===t?void 0:t.posOrderId,tenantId:null===t||void 0===t?void 0:t.tenantId},r=o+1;e(Object(i.d)(n,(()=>m(r,d,null))))},g=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n={orderId:null===t||void 0===t?void 0:t.orderId,tenantId:null===t||void 0===t?void 0:t.tenantId,customerId:null===t||void 0===t?void 0:t.customerId},r=o+1;e(Object(d.f)(n,(()=>m(r,i,null))))},j=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null!==t&&void 0!==t&&t.isExternalTrackOrder?N(e,t,o,d):g(e,t,o,d)},L=(e,t,o,d,i,n)=>{null!==t&&void 0!==t&&t.orderId?0===o||a(d)&&o<u.a?j(e,t,o,i):a(d)&&o>=u.a&&(localStorage.setItem("paymentStatus",l.Td.FAILED),Object(r.Se)(n)):Object(r.Me)(n)},C=(e,t,o,d,i)=>{d&&O(e)?Object(r.Se)(i):null!==e&&void 0!==e&&e.status&&(null===e||void 0===e?void 0:e.status)!==(null===t||void 0===t?void 0:t.status)?o({...t,status:null===e||void 0===e?void 0:e.status,orderAcceptedLoading:null===e||void 0===e?void 0:e.orderAcceptedLoading,deliveryPartner:null===e||void 0===e?void 0:e.deliveryPartner,deliveryDistaRetryCountFlag:(null===t||void 0===t?void 0:t.deliveryDistaRetryCountFlag)+1}):o({...t,deliveryDistaRetryCountFlag:(null===t||void 0===t?void 0:t.deliveryDistaRetryCountFlag)+1})},p=(e,t,o)=>{if(O(e)&&!t){const e=setTimeout((()=>{e&&clearTimeout(e)}),u.d)}},P=(e,t,o,d)=>{var i,n;return{...y(e,t,!1,o),orderAcceptedLoading:(null===t||void 0===t?void 0:t.orderAcceptedLoading)||!1,deliveryPartner:null,deliveryDistaRetryCountFlag:0,operatingTime:null===d||void 0===d||null===(i=d.store)||void 0===i||null===(n=i.summary)||void 0===n?void 0:n.timings}},y=function(e,t){var o,d,i,n,r,l,u,c;let v=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const O={orderId:(null===t||void 0===t?void 0:t.id)||(null===a||void 0===a?void 0:a.id),customerId:(null===t||void 0===t||null===(o=t.customer)||void 0===o?void 0:o.id)||(null===a||void 0===a||null===(d=a.customer)||void 0===d?void 0:d.id),tenantId:e,service:(null===t||void 0===t?void 0:t.service)||(null===a||void 0===a?void 0:a.service),status:(null===t||void 0===t?void 0:t.status)||(null===a||void 0===a?void 0:a.status),orderTime:(null===t||void 0===t?void 0:t.fulfillmentDateTime)||(null===a||void 0===a?void 0:a.fulfillmentDateTime),deliveryPartner:(null===t||void 0===t?void 0:t.deliveryPartner)||(null===a||void 0===a?void 0:a.deliveryPartner),posOrderId:(null===t||void 0===t?void 0:t.posOrderId)||(null===a||void 0===a?void 0:a.posOrderId),userEmail:(null===t||void 0===t||null===(i=t.customer)||void 0===i?void 0:i.email)||(null===a||void 0===a||null===(n=a.customer)||void 0===n?void 0:n.email),userPhone:(null===t||void 0===t||null===(r=t.customer)||void 0===r?void 0:r.phoneNumber)||(null===t||void 0===t||null===(l=t.customer)||void 0===l?void 0:l.phone)||(null===a||void 0===a||null===(u=a.customer)||void 0===u?void 0:u.phoneNumber),postOrderDetails:t,isExternalTrackOrder:v};var E,I,D;null!==s&&void 0!==s&&null!==(c=s.storesWithStatus)&&void 0!==c&&c.length&&(O.operatingTime=null===s||void 0===s||null===(E=s.storesWithStatus)||void 0===E||null===(I=E[0])||void 0===I||null===(D=I.summary)||void 0===D?void 0:D.timings);return O},V=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],d=(e=>{var t;return null!==e&&void 0!==e&&e.orderAccepted&&Object.keys(null===e||void 0===e?void 0:e.orderAccepted).length&&null!==e&&void 0!==e&&null!==(t=e.orderAccepted)&&void 0!==t&&t.id?null===e||void 0===e?void 0:e.orderAccepted:null})(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return null===d&&(d=(e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.pastOrderResponse)&&void 0!==t&&t.length&&null!==e&&void 0!==e&&e.pastOrderResponse[0].id?null===e||void 0===e?void 0:e.pastOrderResponse[0]:null})(e),o&&null===d&&(d=t&&Object.keys(null===t||void 0===t?void 0:t.postOrderDetails).length?null===t||void 0===t?void 0:t.postOrderDetails:{})),d||{}},Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(localStorage.getItem(l.gd.PAYMENT_STATUS)!==l.Td.FAILED){var o,n,r,u;if(t&&(null===(o=window)||void 0===o||null===(n=o.location)||void 0===n?void 0:n.pathname)===(null===l.Ae||void 0===l.Ae?void 0:l.Ae.PAYMENT_SUCCESS)||(null===(r=window)||void 0===r||null===(u=r.location)||void 0===u?void 0:u.pathname)===(null===l.Ae||void 0===l.Ae?void 0:l.Ae.CHECKOUT))return!1;(e=>{e(Object(d.h)())})(e),(e=>{e(Object(i.e)())})(e)}(e=>{e(Object(v.z)())})(e),(e=>{e(Object(i.a)({value:[]}))})(e),sessionStorage.removeItem(l.gd.ORDER_TRACKING)}}}]);